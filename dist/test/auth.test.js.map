{"version":3,"sources":["../../src/test/auth.test.ts"],"sourcesContent":["import request from 'supertest';\nimport { App } from '@/app';\nimport pg from '@database';\nimport { CreateCustomerDto } from '@dtos/customer.dto';\nimport { CustomersRoute } from '@routes/customers.route';\n\nafterAll(async () => {\n  await new Promise<void>(resolve => setTimeout(() => resolve(), 500));\n  await pg.end();\n});\n\ndescribe('Testing Auth', () => {\n  describe('[POST] /register', () => {\n    const customerRoute = new CustomersRoute();\n    const app = new App([customerRoute]);\n    const userData: CreateCustomerDto = {\n      name: 'name',\n      phone: '998949315433',\n      password: 'password12',\n    };\n    it('response should have the Create userData', async () => {\n      const response = await request(app.getServer()).post('/customer/register').send(userData);\n      expect(response.statusCode).toBe(201);\n    });\n    it('validation error', async () => {\n      userData.password = '';\n      const response = await request(app.getServer()).post('/customer/register').send(userData);\n      expect(response.statusCode).toBe(400);\n    });\n  });\n\n  describe('[POST] /login', () => {\n    it('response should have the Set-Cookie header with the Authorization token', async () => {\n      const userData: CreateCustomerDto = {\n        name: 'name',\n        phone: '998949315431',\n        password: 'password12',\n      };\n      const customerRoute = new CustomersRoute();\n      const app = new App([customerRoute]);\n\n      const response = await request(app.getServer()).post('/customer/login').send(userData);\n      expect(response.statusCode).toBe(200);\n    });\n  });\n});\n"],"names":["afterAll","Promise","resolve","setTimeout","pg","end","describe","customerRoute","CustomersRoute","app","App","userData","name","phone","password","it","response","request","getServer","post","send","expect","statusCode","toBe"],"mappings":";;;;kEAAoB;qBACA;iEACL;gCAEgB;;;;;;AAE/BA,SAAS;IACP,MAAM,IAAIC,QAAcC,CAAAA,UAAWC,WAAW,IAAMD,WAAW;IAC/D,MAAME,iBAAE,CAACC,GAAG;AACd;AAEAC,SAAS,gBAAgB;IACvBA,SAAS,oBAAoB;QAC3B,MAAMC,gBAAgB,IAAIC,8BAAc;QACxC,MAAMC,MAAM,IAAIC,QAAG,CAAC;YAACH;SAAc;QACnC,MAAMI,WAA8B;YAClCC,MAAM;YACNC,OAAO;YACPC,UAAU;QACZ;QACAC,GAAG,4CAA4C;YAC7C,MAAMC,WAAW,MAAMC,IAAAA,kBAAO,EAACR,IAAIS,SAAS,IAAIC,IAAI,CAAC,sBAAsBC,IAAI,CAACT;YAChFU,OAAOL,SAASM,UAAU,EAAEC,IAAI,CAAC;QACnC;QACAR,GAAG,oBAAoB;YACrBJ,SAASG,QAAQ,GAAG;YACpB,MAAME,WAAW,MAAMC,IAAAA,kBAAO,EAACR,IAAIS,SAAS,IAAIC,IAAI,CAAC,sBAAsBC,IAAI,CAACT;YAChFU,OAAOL,SAASM,UAAU,EAAEC,IAAI,CAAC;QACnC;IACF;IAEAjB,SAAS,iBAAiB;QACxBS,GAAG,2EAA2E;YAC5E,MAAMJ,WAA8B;gBAClCC,MAAM;gBACNC,OAAO;gBACPC,UAAU;YACZ;YACA,MAAMP,gBAAgB,IAAIC,8BAAc;YACxC,MAAMC,MAAM,IAAIC,QAAG,CAAC;gBAACH;aAAc;YAEnC,MAAMS,WAAW,MAAMC,IAAAA,kBAAO,EAACR,IAAIS,SAAS,IAAIC,IAAI,CAAC,mBAAmBC,IAAI,CAACT;YAC7EU,OAAOL,SAASM,UAAU,EAAEC,IAAI,CAAC;QACnC;IACF;AACF"}