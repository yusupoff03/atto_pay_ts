{"version":3,"sources":["../../src/database/redis.ts"],"sourcesContent":["import { createClient, RedisClientType } from 'redis';\nimport { REDIS_TLS } from '@config';\n\nexport class RedisClient {\n  private client: RedisClientType;\n\n  constructor() {\n    this.client = createClient({\n      url: 'redis://default:871bcbfae7524f79b0c553b102ecfd36@first-kid-32082.kv.vercel-storage.com:32082',\n      socket: {\n        tls: REDIS_TLS === 'true',\n      },\n    });\n\n    this.client.on('error', err => console.error(err));\n    this.client.connect();\n  }\n\n  private execute<T>(promise: Promise<T>, cb: (err: Error | null, result?: T) => void = () => {}): Promise<T> {\n    return promise\n      .then(res => {\n        cb(null, res);\n        return res;\n      })\n      .catch(err => {\n        cb(err);\n        throw err;\n      });\n  }\n\n  public hSet(key: string, field: string, value: string, cb: (err: Error | null, result?: number) => void = () => {}): Promise<number> {\n    return this.execute(this.client.hSet(key, field, value), cb);\n  }\n\n  public hGet(key: string, field: string, cb: (err: Error | null, result?: string | null) => void = () => {}): Promise<string | null> {\n    return this.execute(this.client.hGet(key, field), cb);\n  }\n\n  public hDel(key: string, field: string, cb: (err: Error | null, result?: number) => void = () => {}): Promise<number> {\n    return this.execute(this.client.hDel(key, field), cb);\n  }\n\n  public disconnect(): void {\n    this.client.quit();\n  }\n}\n\nexport default RedisClient;\n"],"names":["RedisClient","execute","promise","cb","then","res","catch","err","hSet","key","field","value","client","hGet","hDel","disconnect","quit","constructor","createClient","url","socket","tls","REDIS_TLS","on","console","error","connect"],"mappings":";;;;;;;;;;;IAGaA,WAAW;eAAXA;;IA4Cb,OAA2B;eAA3B;;;uBA/C8C;wBACpB;;;;;;;;;;;;;;AAEnB,IAAA,AAAMA,cAAN,MAAMA;IAeHC,QAAWC,OAAmB,EAAEC,KAA8C,KAAO,CAAC,EAAc;QAC1G,OAAOD,QACJE,IAAI,CAACC,CAAAA;YACJF,GAAG,MAAME;YACT,OAAOA;QACT,GACCC,KAAK,CAACC,CAAAA;YACLJ,GAAGI;YACH,MAAMA;QACR;IACJ;IAEOC,KAAKC,GAAW,EAAEC,KAAa,EAAEC,KAAa,EAAER,KAAmD,KAAO,CAAC,EAAmB;QACnI,OAAO,IAAI,CAACF,OAAO,CAAC,IAAI,CAACW,MAAM,CAACJ,IAAI,CAACC,KAAKC,OAAOC,QAAQR;IAC3D;IAEOU,KAAKJ,GAAW,EAAEC,KAAa,EAAEP,KAA0D,KAAO,CAAC,EAA0B;QAClI,OAAO,IAAI,CAACF,OAAO,CAAC,IAAI,CAACW,MAAM,CAACC,IAAI,CAACJ,KAAKC,QAAQP;IACpD;IAEOW,KAAKL,GAAW,EAAEC,KAAa,EAAEP,KAAmD,KAAO,CAAC,EAAmB;QACpH,OAAO,IAAI,CAACF,OAAO,CAAC,IAAI,CAACW,MAAM,CAACE,IAAI,CAACL,KAAKC,QAAQP;IACpD;IAEOY,aAAmB;QACxB,IAAI,CAACH,MAAM,CAACI,IAAI;IAClB;IAtCAC,aAAc;QAFd,uBAAQL,UAAR,KAAA;QAGE,IAAI,CAACA,MAAM,GAAGM,IAAAA,mBAAY,EAAC;YACzBC,KAAK;YACLC,QAAQ;gBACNC,KAAKC,iBAAS,KAAK;YACrB;QACF;QAEA,IAAI,CAACV,MAAM,CAACW,EAAE,CAAC,SAAShB,CAAAA,MAAOiB,QAAQC,KAAK,CAAClB;QAC7C,IAAI,CAACK,MAAM,CAACc,OAAO;IACrB;AA6BF;MAEA,WAAe1B"}