{"version":3,"sources":["../../src/utils/imageStorage.ts"],"sourcesContent":["import { S3, PutObjectCommand, DeleteObjectCommand } from '@aws-sdk/client-s3';\nimport { HttpException } from '@exceptions/httpException';\n\nexport class FileUploader {\n  private s3Client: S3;\n\n  constructor(private region: string, private bucketName: string) {\n    this.s3Client = new S3({\n      region: region,\n      credentials: {\n        accessKeyId: 'AKIAYH6AFTGXQONMGIOM',\n        secretAccessKey: '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',\n      },\n      endpoint: 'https://s3.eu-north-1.amazonaws.com',\n    });\n  }\n\n  async uploadFile(file: any, s3ObjectKey: string): Promise<string> {\n    try {\n      const params = {\n        Bucket: this.bucketName,\n        Key: s3ObjectKey,\n        Body: file.data,\n      };\n      const command = new PutObjectCommand(params);\n      await this.s3Client.send(command);\n      return s3ObjectKey;\n    } catch (err) {\n      throw new HttpException(403, `'Error uploading image to S3:', ${err}`);\n    }\n  }\n  async deleteFile(objectKey: string): Promise<void> {\n    if (!objectKey) return;\n    try {\n      const params = {\n        Bucket: this.bucketName,\n        Key: objectKey,\n      };\n      const command = new DeleteObjectCommand(params);\n      await this.s3Client.send(command);\n    } catch (error) {\n      throw new HttpException(403, `'Error deleting image to S3:', ${error}`);\n    }\n  }\n  public static getUrl(fileName: string): string {\n    if (!fileName) return null;\n    return `https://image-24.s3.eu-north-1.amazonaws.com/${fileName}`;\n  }\n}\n"],"names":["FileUploader","uploadFile","file","s3ObjectKey","params","Bucket","bucketName","Key","Body","data","command","PutObjectCommand","s3Client","send","err","HttpException","deleteFile","objectKey","DeleteObjectCommand","error","getUrl","fileName","constructor","region","S3","credentials","accessKeyId","secretAccessKey","endpoint"],"mappings":";;;;+BAGaA;;;eAAAA;;;0BAH6C;+BAC5B;;;;;;;;;;;;;;AAEvB,IAAA,AAAMA,eAAN,MAAMA;IAcX,MAAMC,WAAWC,IAAS,EAAEC,WAAmB,EAAmB;QAChE,IAAI;YACF,MAAMC,SAAS;gBACbC,QAAQ,IAAI,CAACC,UAAU;gBACvBC,KAAKJ;gBACLK,MAAMN,KAAKO,IAAI;YACjB;YACA,MAAMC,UAAU,IAAIC,0BAAgB,CAACP;YACrC,MAAM,IAAI,CAACQ,QAAQ,CAACC,IAAI,CAACH;YACzB,OAAOP;QACT,EAAE,OAAOW,KAAK;YACZ,MAAM,IAAIC,4BAAa,CAAC,KAAK,CAAC,gCAAgC,EAAED,IAAI,CAAC;QACvE;IACF;IACA,MAAME,WAAWC,SAAiB,EAAiB;QACjD,IAAI,CAACA,WAAW;QAChB,IAAI;YACF,MAAMb,SAAS;gBACbC,QAAQ,IAAI,CAACC,UAAU;gBACvBC,KAAKU;YACP;YACA,MAAMP,UAAU,IAAIQ,6BAAmB,CAACd;YACxC,MAAM,IAAI,CAACQ,QAAQ,CAACC,IAAI,CAACH;QAC3B,EAAE,OAAOS,OAAO;YACd,MAAM,IAAIJ,4BAAa,CAAC,KAAK,CAAC,+BAA+B,EAAEI,MAAM,CAAC;QACxE;IACF;IACA,OAAcC,OAAOC,QAAgB,EAAU;QAC7C,IAAI,CAACA,UAAU,OAAO;QACtB,OAAO,CAAC,6CAA6C,EAAEA,SAAS,CAAC;IACnE;IAzCAC,YAAY,AAAQC,MAAc,EAAE,AAAQjB,UAAkB,CAAE;;;QAFhE,uBAAQM,YAAR,KAAA;aAEoBW,SAAAA;aAAwBjB,aAAAA;QAC1C,IAAI,CAACM,QAAQ,GAAG,IAAIY,YAAE,CAAC;YACrBD,QAAQA;YACRE,aAAa;gBACXC,aAAa;gBACbC,iBAAiB;YACnB;YACAC,UAAU;QACZ;IACF;AAiCF"}